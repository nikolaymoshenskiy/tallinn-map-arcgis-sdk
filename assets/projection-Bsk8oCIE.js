import{cT as C,cU as j,cV as h,cW as S,cX as O,cY as x,ce as $,cZ as _,b7 as b,c_ as v,c$ as Y,bN as B,d0 as W,d1 as z,d2 as J,cf as G,d3 as X}from"./index-CpEBwgYb.js";import{e as Z}from"./mat3f64-q3fE-ZOt.js";import{o as g,e as q}from"./mat4f64-CSKppSlJ.js";import{a as E}from"./spatialReferenceEllipsoidUtils-CWjarewc.js";import{u as V}from"./computeTranslationToOriginAndRotation-Do3yxRCy.js";import{t as L,o as D}from"./DoubleArray-BL6-QkbM.js";import{i as P,T as y}from"./BufferView-CpI7YL_H.js";import{f as H,l as k,e as w}from"./vec3-C1_bp-lC.js";import{n as I}from"./vec4-DEdHfHmo.js";const fr="Projection may be possible after calling projection.load().";function lr(r,o,e,t){r.error(`Failed to project from (wkid:${o.wkid}) to (wkid:${e.wkid}).${t?" ":""}${t}`)}function ur(r,o,e,t,n){return M(m.TO_PCPF,P.fromTypedArray(r),T.NORMAL,y.fromTypedArray(o),y.fromTypedArray(e),t,P.fromTypedArray(n))?n:null}function pr(r,o,e,t,n){return M(m.FROM_PCPF,P.fromTypedArray(r),T.NORMAL,y.fromTypedArray(o),y.fromTypedArray(e),t,P.fromTypedArray(n))?n:null}function Tr(r,o,e){return C(r,o,0,e,E(o),0,r.length/3)?e:null}function mr(r,o,e){return C(r,E(e),0,o,e,0,r.length/3)?o:null}function Pr(r,o,e){return j(c,e),H(o,r,c),h(c)&&k(o,o),o}function yr(r,o,e){return S(c,e),I(o,r,c),h(c)&&k(o,o,4),o}function Ar(r,o,e,t,n){if(!M(m.TO_PCPF,P.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),T.TANGENT,y.fromTypedArray(o),y.fromTypedArray(e),t,P.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT)))return null;for(let i=3;i<r.length;i+=4)n[i]=r[i];return n}function dr(r,o,e,t,n){if(!M(m.FROM_PCPF,P.fromTypedArray(r,16),T.TANGENT,y.fromTypedArray(o),y.fromTypedArray(e),t,P.fromTypedArray(n,16)))return null;for(let i=3;i<r.length;i+=4)n[i]=r[i];return n}var T,m;function R(r,o,e,t,n){switch(V(t,e,p,t),r===m.FROM_PCPF&&X(p,p),o){case T.NORMAL:return j(n,p);case T.TANGENT:return S(n,p)}}function M(r,o,e,t,n,i,u){if(!o)return;const f=t.count,A=E(i);if(U(i))for(let s=0;s<f;s++)n.getVec(s,N),o.getVec(s,l),O(l,l,R(r,e,N,A,c)),u.setVec(s,l);else for(let s=0;s<f;s++){n.getVec(s,N),o.getVec(s,l);const d=x(t.get(s,1));let a=Math.cos(d);e===T.TANGENT!=(r===m.TO_PCPF)&&(a=1/a),R(r,e,N,A,c),r===m.TO_PCPF?(c[0]*=a,c[1]*=a,c[2]*=a,c[3]*=a,c[4]*=a,c[5]*=a):(c[0]*=a,c[3]*=a,c[6]*=a,c[1]*=a,c[4]*=a,c[7]*=a),O(l,l,c),$(l,l),u.setVec(s,l)}return u}function Fr(r){return r.vertexSpace.type==="local"?K(r):Q(r)}function K({vertexSpace:r,transform:o,inSpatialReference:e,outSpatialReference:t,localMode:n,outPositions:i,positions:u}){const f=r.origin??_,A=r.origin!=null?(o==null?void 0:o.localMatrix)??g:g,s=E(e),d=t.isWebMercator&&n||!b(e,s)?e:s;V(e,f,p,d),v(p,p,A);const a=i??L(u.length);return w(a,u,p),C(a,d,0,a,t,0,a.length/3),a}function Q({vertexSpace:r,transform:o,outPositions:e,positions:t,inSpatialReference:n,outSpatialReference:i}){const u=r.origin!=null?(o==null?void 0:o.localMatrix)??g:g,f=e??L(t.length);Y(u,g)?D(f,t):w(f,t,u);const A=r.origin??_;if(!B(A,_)){const[s,d,a]=A;for(let F=0;F<f.length;F+=3)f[F]+=s,f[F+1]+=d,f[F+2]+=a}return C(f,n,0,f,i,0,f.length/3)?f:null}function U(r){return r.isWGS84||W(r)||z(r)||J(r)}(function(r){r[r.NORMAL=0]="NORMAL",r[r.TANGENT=1]="TANGENT"})(T||(T={})),function(r){r[r.TO_PCPF=0]="TO_PCPF",r[r.FROM_PCPF=1]="FROM_PCPF"}(m||(m={}));const N=G(),l=G(),p=q(),c=Z();export{T as VectorType,fr as loadProjectErrorMessage,lr as logProjectionError,Fr as project,mr as projectFromPCPF,pr as projectNormalFromPCPF,ur as projectNormalToPCPF,dr as projectTangentFromPCPF,Ar as projectTangentToPCPF,Tr as projectToPCPF,Pr as transformNormal,yr as transformTangent};
